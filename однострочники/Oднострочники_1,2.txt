ls -l | perl -lnaE 'if (scalar @F < 8) {pass} else {$,=";"; if (scalar @F > 9) {$i=9; while ($i < scalar @F){@F[8] = @F[8]." ".@F[$i]; delete @F[$i]; $i++};} say @F}' > output.txt

cat output.txt | perl -laF";" -E '$b++; if (@F[4] > 1024*1024) {$i++; say @F[8]}}{say "$b, $i"'
